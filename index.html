<!DOCTYPE html>
<html>
<head>
  <title>Free TTS Player with Named Save</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 40px auto;
      display: flex;
      gap: 20px;
    }
    #left { flex: 2; }
    #right {
      flex: 1;
      border-left: 1px solid #ccc;
      padding-left: 20px;
    }
    textarea, input {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      margin-top: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    audio {
      margin-top: 20px;
      width: 100%;
    }
    .entry {
      background: #f7f7f7;
      padding: 10px;
      margin-bottom: 8px;
      border-radius: 6px;
      cursor: pointer;
      position: relative;
    }
    .entry-title {
      font-weight: bold;
    }
    .entry-text {
      font-size: 14px;
      color: #555;
    }
    .delete-btn {
      position: absolute;
      right: 10px;
      top: 6px;
      cursor: pointer;
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <div id="left">
    <h1>Text to Speech Player</h1>

    <input id="entryName" type="text" placeholder="Entry name (optional)">
    <textarea id="text" rows="4" placeholder="Enter text here..."></textarea>

    <button onclick="playAudio()">Play</button>
    <button onclick="saveEntry()">Save Entry</button>

    <audio id="audio" controls style="display:none;"></audio>
  </div>

  <div id="right">
    <h2>Saved Entries</h2>
    <div id="history"></div>
  </div>

  <script>
    // Load saved entries on startup
    function loadHistory() {
      const historyDiv = document.getElementById("history");
      historyDiv.innerHTML = "";

      const entries = JSON.parse(localStorage.getItem("tts_entries") || "[]");

      entries.forEach((entry, index) => {
        const div = document.createElement("div");
        div.className = "entry";

        const title = document.createElement("div");
        title.className = "entry-title";
        title.textContent = entry.name || "(Unnamed)";
        div.appendChild(title);

        const textPreview = document.createElement("div");
        textPreview.className = "entry-text";
        textPreview.textContent = entry.text;
        div.appendChild(textPreview);

        // Load on click
        div.onclick = () => {
          document.getElementById("entryName").value = entry.name;
          document.getElementById("text").value = entry.text;
        };

        // Delete button
        const del = document.createElement("span");
        del.className = "delete-btn";
        del.textContent = "Ã—";
        del.onclick = (event) => {
          event.stopPropagation();
          deleteEntry(index);
        };

        div.appendChild(del);
        historyDiv.appendChild(div);
      });
    }

    // Save entry when clicking "Save Entry"
    function saveEntry() {
      const name = document.getElementById("entryName").value.trim();
      const text = document.getElementById("text").value.trim();

      if (!text) return alert("Cannot save an empty text entry.");

      let entries = JSON.parse(localStorage.getItem("tts_entries") || "[]");

      entries.unshift({ name: name || "Unnamed", text: text });
      entries = entries.slice(0, 100); // limit to 100 entries

      localStorage.setItem("tts_entries", JSON.stringify(entries));
      loadHistory();
    }

    function deleteEntry(index) {
      let entries = JSON.parse(localStorage.getItem("tts_entries") || "[]");
      entries.splice(index, 1);
      localStorage.setItem("tts_entries", JSON.stringify(entries));
      loadHistory();
    }

    function playAudio() {
      const input = document.getElementById("text").value.trim();
      if (!input) return alert("Please enter text.");

      const encoded = encodeURIComponent(input);
      const url = `http://tts.cyzon.us/tts?text=${encoded}`;

      const audio = document.getElementById("audio");
      audio.src = url;
      audio.style.display = "block";
      audio.play();
    }

    window.onload = loadHistory;
  </script>

</body>
</html>
